
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jakhong League System 4.1 (Full Fixes & Themed)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,300;0,400;0,600;0,800;1,800&display=swap" rel="stylesheet">

    <style>
        /* --- DYNAMIC THEME VARIABLES (NEW) --- */
        :root {
            --primary-color: #facc15; /* Default Yellow-400 (Accent) */
            --secondary-color: #1c365b; /* Default Dark Blue (Header/Base Gradient Start) */
            --theme-end: #0c1626;   /* Very Dark Blue (Fixed Background Base) */
        }
        body {
            font-family: 'Kanit', sans-serif;
            background-color: var(--theme-end);
            color: white;
            background-image: radial-gradient(circle at top right, #34050520 0%, transparent 40%),
                              radial-gradient(circle at bottom left, #1a1a1a 0%, transparent 40%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(12, 22, 38, 0.7);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        .navbar {
            background: rgba(12, 22, 38, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--primary-color); /* Uses Primary Color */
        }
        .nav-btn {
            color: #ccc;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        .nav-btn.active {
            background: var(--primary-color); /* Uses Primary Color */
            color: #000;
            font-weight: 700;
            border: 1px solid var(--primary-color);
            transform: scale(1.05);
        }
        .nav-btn:hover:not(.active) {
            background: rgba(var(--primary-color), 0.1); /* Use primary color with opacity */
            color: var(--primary-color);
        }
        .logo-circle {
            border-radius: 50%;
            object-fit: cover;
            aspect-ratio: 1/1;
        }

        /* Player Card Design */
        .player-card {
            background: linear-gradient(145deg, #1f2937, #0c1626);
            transition: all 0.3s;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .player-photo-container {
            position: relative;
            overflow: hidden;
            background-color: #0c1626;
            border-bottom: 3px solid var(--primary-color); /* Uses Primary Color */
            aspect-ratio: 3 / 4; 
        }
        .player-photo-container img {
            height: 100%;
            width: 100%;
            object-fit: cover;
            object-position: top center;
        }
        /* Player Number Style */
        .player-num-tag {
            position: absolute;
            top: 5px;
            left: 5px;
            background: var(--primary-color); /* Uses Primary Color */
            color: black;
            font-size: 0.9rem;
            font-weight: 900;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 2px solid white;
            z-index: 20;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }
        /* Player Card (Cards Display) */
        .player-stat-badge {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 900;
            position: absolute;
            bottom: 2px;
            left: 50%;
            transform: translateX(-50%);
            border: 1px solid white;
            z-index: 10;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #555; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--primary-color); } /* Uses Primary Color */
        .no-scrollbar::-webkit-scrollbar { display: none; }

        .outline-text {
            text-shadow: 2px 2px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000;
        }
        
        /* Schedule Grouping */
        .schedule-group-header {
            background-color: var(--primary-color); /* Uses Primary Color */
            color: black;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: bold;
            text-align: center;
            margin-top: 1.5rem;
            box-shadow: 0 4px 10px rgba(var(--primary-color), 0.2); /* Uses Primary Color */
        }
        /* Daily Summary Score Style (FIXED: Score Overlap) */
        .daily-score-box {
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2.5rem; /* 3xl */
            font-weight: 900; /* black */
            letter-spacing: -0.05em; /* tracking-tighter */
            position: relative;
        }
        .daily-score-number {
            padding: 0 0.5rem;
            border-radius: 6px;
            text-shadow: 2px 2px 0 #000;
            line-height: 1;
            /* FIX: Ensure score numbers don't overlap */
            z-index: 10; 
        }
        .daily-vs {
            /* FIX: Make VS smaller and central */
            font-size: 1rem;
            font-weight: 700;
            margin: 0 0.3rem;
            z-index: 5;
            color: #ccc;
        }

        /* FIX: Today Scorer Number Tag */
        .today-scorer-num-tag {
            position: absolute;
            top: 5px;
            right: 5px;
            background: black; 
            color: white; 
            font-size: 0.7rem;
            font-weight: 900;
            width: 22px;
            height: 22px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            border: 2px solid var(--primary-color);
            z-index: 20;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.5);
        }

    </style>
</head>
<body class="flex flex-col">

    <nav class="navbar sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between py-3">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-full flex items-center justify-center shadow-lg border border-white" 
                         style="background: linear-gradient(135deg, var(--primary-color), var(--secondary-color))">
                        <i class="fas fa-trophy text-black"></i>
                    </div>
                    <h1 class="text-xl font-extrabold italic uppercase tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500" 
                        id="nav-title">
                        JAKHONG SYSTEM
                    </h1>
                </div>
                <button onclick="toggleSettings()" class="text-gray-400 hover:text-white transition"><i class="fas fa-cog text-xl"></i></button>
            </div>
            <div class="flex overflow-x-auto gap-3 pb-3 no-scrollbar">
                <button onclick="nav('home', this)" class="nav-btn active px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-home"></i> แดชบอร์ด</button>
                <button onclick="nav('leaderboard', this)" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-list-ol"></i> ตารางคะแนน</button>
                <button onclick="nav('schedule', this)" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-calendar-alt"></i> โปรแกรมแข่ง</button>
                <button onclick="nav('daily', this)" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-star"></i> สรุปผล/ดาวซัลโว</button>
                <button onclick="nav('stats', this)" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-chart-bar"></i> บันทึกสถิติ</button>
                <button onclick="nav('teams', this)" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-shield-alt"></i> จัดการทีม</button>
                <button onclick="nav('players', this)" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-users"></i> รายชื่อนักเตะ</button>
            </div>
        </div>
    </nav>

    <main class="flex-grow container mx-auto px-2 py-6 md:px-4">

        <div id="page-home" class="section fade-in">
            <div class="glass p-6 rounded-2xl mb-6">
                <h2 class="text-2xl font-extrabold mb-4 flex items-center gap-3" style="color: var(--primary-color);">
                    <i class="fas fa-chart-line"></i> สรุปภาพรวมลีก
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4" style="border-color: var(--primary-color);">
                        <div class="text-3xl font-black" id="stat-total-teams">0</div>
                        <div class="text-gray-400 text-sm">จำนวนทีม</div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4 border-green-500">
                        <div class="text-3xl font-black" id="stat-total-stats">0</div>
                        <div class="text-gray-400 text-sm">สถิติที่บันทึก</div> 
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4 border-red-500">
                        <div class="text-3xl font-black" id="stat-total-goals">0</div>
                        <div class="text-gray-400 text-sm">รวมประตู</div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4 border-blue-500">
                        <div class="text-3xl font-black" id="stat-total-players">0</div>
                        <div class="text-gray-400 text-sm">จำนวนนักเตะ</div>
                    </div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div id="leader-team-card" class="glass p-5 rounded-2xl border-l-4 flex items-center gap-4" style="border-color: var(--primary-color);">
                    <i class="fas fa-trophy text-4xl" style="color: var(--primary-color);"></i>
                    <div>
                        <div class="text-lg font-bold" style="color: var(--primary-color);">ทีมนำตารางคะแนน:</div>
                        <div class="text-2xl font-black uppercase" id="leader-team-name">N/A</div>
                        <div class="text-sm text-gray-300"><span id="leader-team-pts">0</span> แต้ม</div>
                    </div>
                </div>
                <div id="top-scorer-card" class="glass p-5 rounded-2xl border-l-4 border-red-500 flex items-center gap-4">
                    <i class="fas fa-futbol text-4xl text-red-500"></i>
                    <div>
                        <div class="text-lg font-bold text-red-400">ดาวซัลโวสูงสุด:</div>
                        <div class="text-2xl font-black uppercase" id="top-scorer-name">N/A</div>
                        <div class="text-sm text-gray-300"><span id="top-scorer-goals">0</span> ประตู</div>
                    </div>
                </div>
            </div>


            <div class="glass p-6 rounded-2xl">
                <h2 class="text-2xl font-extrabold mb-4 flex items-center gap-3" style="color: var(--primary-color);">
                    <i class="fas fa-user-tie"></i> รายชื่อผู้จัดการทีม
                </h2>
                <div id="manager-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    </div>
            </div>
        </div>

        <div id="page-leaderboard" class="section hidden fade-in">
            <div class="glass p-3 rounded-xl mb-4 flex flex-wrap gap-4 items-center text-xs">
                <strong class="text-yellow-400">ปรับแต่งตาราง:</strong>
                <div><label>สีพื้นตาราง</label><input type="color" id="lb-bg-body" value="#1e293b" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>สีตัวอักษร</label><input type="color" id="lb-body-text-color" value="#ffffff" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div class="h-4 w-px bg-gray-600"></div>
                <div><label>สีพื้นหลังหัวตาราง 1</label><input type="color" id="lb-header-grad-1" value="#1c365b" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>สีพื้นหลังหัวตาราง 2</label><input type="color" id="lb-header-grad-2" value="#0c1626" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>สีตัวอักษรหัวตาราง</label><input type="color" id="lb-header-text-color" value="#ffffff" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div class="h-4 w-px bg-gray-600"></div>
                <div><label>สีพื้นหลังแต้ม 1</label><input type="color" id="lb-pts-grad-1" value="#facc15" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>สีพื้นหลังแต้ม 2</label><input type="color" id="lb-pts-grad-2" value="#e3a008" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
            </div>

            <div class="rounded-xl overflow-hidden shadow-2xl">
                <div id="lb-banner" class="p-6 text-center relative" style="background: linear-gradient(135deg, #1c365b, #0c1626);">
                    <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10"></div>
                    <h2 contenteditable="true" id="lb-title" class="relative text-3xl md:text-5xl font-extrabold uppercase italic outline-text tracking-wider z-10 focus:outline-none focus:border-b border-white" style="color: var(--primary-color);">
                        ตารางคะแนน JAKHONG SENIOR CUP
                    </h2>
                </div>
                
                <div class="overflow-x-auto bg-gray-900">
                    <table class="w-full text-left border-collapse min-w-[700px]" id="lb-table">
                        <thead>
                            <tr class="uppercase text-sm tracking-wider border-b border-white/10" id="lb-thead-row">
                                <th class="p-4" style="color: #ffffff;">อันดับ</th>
                                <th class="p-4" style="color: #ffffff;">ทีม</th>
                                <th class="p-4 text-center" style="color: #ffffff;">แข่ง</th>
                                <th class="p-4 text-center" style="color: #ffffff;">ชนะ</th>
                                <th class="p-4 text-center" style="color: #ffffff;">เสมอ</th>
                                <th class="p-4 text-center" style="color: #ffffff;">แพ้</th>
                                <th class="p-4 text-center" style="color: #ffffff;">ได้/เสีย</th>
                                <th class="p-4 text-center" style="color: #ffffff;">+/-</th>
                                <th class="p-0 text-center text-xl">
                                    <div style="background: linear-gradient(135deg, var(--primary-color), #e3a008); color: black;" class="font-black">แต้ม</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="lb-body" class="text-base font-medium"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="page-schedule" class="section hidden fade-in">
            <div class="glass p-3 rounded-xl mb-4 flex flex-wrap gap-4 items-center text-xs">
                <button onclick="openAddSchedModal()" class="bg-green-600 text-white px-3 py-1 rounded font-bold hover:bg-green-500 transition">+ เพิ่มแมทช์</button>
                <div class="h-4 w-px bg-gray-600"></div>
                <label>สีพื้นหลัง:</label>
                <input type="color" id="sc-bg-color" value="#1c365b" class="w-5 h-5 rounded cursor-pointer" oninput="renderSchedule()">
                <label>สีตัวอักษร:</label>
                <input type="color" id="sc-text-color" value="#ffffff" class="w-5 h-5 rounded cursor-pointer" oninput="renderSchedule()">
                <label>สีพื้นหลังหัวข้อ:</label>
                <input type="color" id="sc-pill-color" value="#facc15" class="w-5 h-5 rounded cursor-pointer" oninput="renderSchedule()">
                <input type="text" id="sc-header-text" value="โปรแกรมการแข่งขัน" class="bg-gray-700 text-white px-2 rounded w-32" oninput="renderSchedule()">
            </div>

            <div class="flex flex-col min-h-[500px] rounded-xl overflow-hidden shadow-2xl relative bg-gray-900">
                <div class="flex-1 p-4 md:p-8 relative z-10 w-full" id="sc-container">
                    <div class="text-center mb-8">
                        <span id="sc-pill" class="inline-block px-8 py-2 rounded-full text-xl md:text-2xl font-bold uppercase shadow-lg text-black mb-2 transform skew-x-[-10deg]" style="background-color: var(--primary-color);">
                            โปรแกรมการแข่งขัน
                        </span>
                    </div>

                    <div class="flex gap-3 justify-center mb-6 overflow-x-auto no-scrollbar" id="group-tabs-container">
                        <button onclick="setGroupFilter('All', this)" class="group-tab active text-black px-4 py-1 rounded-full text-sm font-bold transition hover:bg-yellow-600" style="background-color: var(--primary-color);">ทั้งหมด</button>
                        <button onclick="setGroupFilter('A', this)" class="group-tab bg-gray-700 text-white px-4 py-1 rounded-full text-sm font-medium transition hover:bg-gray-600">กลุ่ม A</button>
                        <button onclick="setGroupFilter('B', this)" class="group-tab bg-gray-700 text-white px-4 py-1 rounded-full text-sm font-medium transition hover:bg-gray-600">กลุ่ม B</button>
                    </div>
                    
                    <div id="sched-list" class="space-y-4 max-w-4xl mx-auto">
                        </div>
                </div>

                <div id="sc-bg-overlay" class="absolute inset-0 z-0 bg-gradient-to-br from-blue-900 to-black opacity-90"></div>
            </div>
        </div>

        <div id="page-daily" class="section hidden fade-in">
            <div class="glass p-4 rounded-xl mb-6 flex flex-wrap gap-6 items-end">
                <div>
                    <label class="text-xs text-gray-400 block mb-1">เลือกวันที่</label>
                    <input type="date" id="daily-date" class="bg-black border border-gray-600 p-2 rounded text-white text-sm w-full" onchange="renderDaily()">
                </div>
                <div>
                    <label class="text-xs text-gray-400 block mb-1">เรียงดาวซัลโว</label>
                    <select id="daily-scorer-sort" class="bg-black border border-gray-600 p-2 rounded text-white text-sm" onchange="renderDaily()">
                        <option value="goals">ประตู (สูงสุด)</option>
                        <option value="assists">แอสซิสต์ (สูงสุด)</option>
                        <option value="name">ชื่อ</option>
                        <option value="number">เบอร์เสื้อ</option>
                    </select>
                </div>

                <div class="flex gap-2">
                    <div><label class="text-xs text-gray-400 block mb-1">สีสกอร์ 1</label><input type="color" id="daily-score-grad-1" value="#facc15" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">สีสกอร์ 2</label><input type="color" id="daily-score-grad-2" value="#e3a008" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    
                    <div><label class="text-xs text-gray-400 block mb-1">สีชื่อทีม</label><input type="color" id="daily-team-name-color" value="#ffffff" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div> 
                    <div><label class="text-xs text-gray-400 block mb-1">สีพื้นแถบ 1</label><input type="color" id="daily-row-bg-1" value="#1f2937" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">สีพื้นแถบ 2</label><input type="color" id="daily-row-bg-2" value="#0c1626" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                </div>
                <div class="flex gap-2">
                    <div><label class="text-xs text-gray-400 block mb-1">แบนเนอร์ 1</label><input type="color" id="daily-banner-grad-1" value="#1c365b" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">แบนเนอร์ 2</label><input type="color" id="daily-banner-grad-2" value="#0c1626" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">อักษรแบนเนอร์</label><input type="color" id="daily-banner-text" value="#facc15" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">ขอบแบนเนอร์</label><input type="color" id="daily-banner-border" value="#facc15" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                </div>
            </div>

            <div id="daily-preview" class="bg-white max-w-[900px] mx-auto shadow-2xl overflow-hidden pb-10 rounded-xl">
                
                <div id="daily-header" class="py-4 px-4 flex flex-wrap items-center justify-between relative border-b-4 border-yellow-500">
                    <div class="flex items-center gap-3 z-10">
                        <img id="daily-logo-img" src="" class="w-12 h-12 object-contain drop-shadow-md bg-white rounded-full p-1 border border-yellow-400">
                        <div contenteditable="true" id="daily-title-edit" class="text-xl md:text-3xl font-extrabold uppercase italic leading-none outline-text text-yellow-400" style="text-shadow: 2px 2px 0 #000;">
                            สรุปผลการแข่งขัน 25/11/2568 JAKHONG LEAGUE 3
                        </div>
                    </div>
                </div>

                <div class="p-4 md:p-8 bg-gray-900 min-h-[200px] space-y-3" id="daily-matches-container"></div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-0 border-t-4 border-black mt-4">
                    
                    <div class="md:col-span-1 bg-gray-800 p-4 border-r border-gray-700 flex flex-col">
                        <h3 class="text-center font-bold text-yellow-400 uppercase
