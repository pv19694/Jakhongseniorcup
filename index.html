
<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jakhong League System 4.0 (Enhanced Design)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,300;0,400;0,600;0,800;1,800&display=swap" rel="stylesheet">

    <style>
        :root {
            --theme-start: #1c365b; /* Dark Blue */
            --theme-end: #0c1626;   /* Very Dark Blue */
            --accent-color: #facc15; /* Yellow-400 */
        }
        body {
            font-family: 'Kanit', sans-serif;
            background-color: var(--theme-end);
            color: white;
            background-image: radial-gradient(circle at top right, #34050520 0%, transparent 40%),
                              radial-gradient(circle at bottom left, #1a1a1a 0%, transparent 40%);
            min-height: 100vh;
        }
        .glass {
            background: rgba(12, 22, 38, 0.7);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }
        .navbar {
            background: rgba(12, 22, 38, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--accent-color);
        }
        .nav-btn {
            color: #ccc;
            border: 1px solid transparent;
            transition: all 0.2s;
        }
        .nav-btn.active {
            background: var(--accent-color);
            color: #000;
            font-weight: 700;
            border: 1px solid var(--accent-color);
            transform: scale(1.05);
        }
        .nav-btn:hover:not(.active) {
            background: rgba(250, 202, 21, 0.1);
            color: var(--accent-color);
        }
        .logo-circle {
            border-radius: 50%;
            object-fit: cover;
            aspect-ratio: 1/1;
        }

        /* Player Card Design (Narrower, better aspect ratio) */
        .player-card {
            background: linear-gradient(145deg, #1f2937, #0c1626);
            transition: all 0.3s;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.6);
            border: 1px solid rgba(255, 255, 255, 0.08);
        }
        .player-photo-container {
            position: relative;
            overflow: hidden;
            background-color: #0c1626;
            border-bottom: 3px solid var(--accent-color);
            /* Define a more specific aspect ratio for player photos */
            aspect-ratio: 3 / 4; 
        }
        .player-photo-container img {
             /* Ensure image covers the container */
            height: 100%;
            width: 100%;
            object-fit: cover;
            object-position: top center; /* Focus on the top part (head/body) */
        }
        .player-photo-container::before {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 50%;
            background: linear-gradient(to top, rgba(12, 22, 38, 1) 0%, rgba(12, 22, 38, 0) 100%);
            z-index: 1;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #111; }
        ::-webkit-scrollbar-thumb { background: #555; border-radius: 3px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent-color); }
        .no-scrollbar::-webkit-scrollbar { display: none; }

        .outline-text {
            text-shadow: 2px 2px 0 #000, -1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000;
        }
        
        /* Leaderboard Style */
        #lb-table {
            border-collapse: separate;
            border-spacing: 0 5px;
        }
        #lb-table thead th:last-child {
            /* For Points column gradient */
            padding: 0; 
        }
        #lb-table thead th:last-child > div {
            padding: 1rem;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        #lb-table tbody tr {
            border-radius: 8px;
            overflow: hidden;
            background-color: #1e293b;
            transition: background-color 0.2s;
        }
        #lb-table tbody tr:hover {
            background-color: #2a3952;
        }
        #lb-table tbody tr td:last-child {
             /* For Points column body */
            padding: 1rem;
        }


        /* Schedule Grouping */
        .schedule-group-header {
            background-color: var(--accent-color);
            color: black;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-weight: bold;
            text-align: center;
            margin-top: 1.5rem;
            box-shadow: 0 4px 10px rgba(250, 202, 21, 0.2);
        }

    </style>
</head>
<body class="flex flex-col">

    <nav class="navbar sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex items-center justify-between py-3">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-yellow-400 to-yellow-600 rounded-full flex items-center justify-center shadow-lg border border-white">
                        <i class="fas fa-trophy text-black"></i>
                    </div>
                    <h1 class="text-xl font-extrabold italic uppercase tracking-widest text-transparent bg-clip-text bg-gradient-to-r from-yellow-200 to-yellow-500">
                        JAKHONG SYSTEM
                    </h1>
                </div>
                <button onclick="toggleSettings()" class="text-gray-400 hover:text-white transition"><i class="fas fa-cog text-xl"></i></button>
            </div>
            <div class="flex overflow-x-auto gap-3 pb-3 no-scrollbar">
                <button onclick="nav('home')" class="nav-btn active px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-home"></i> ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</button>
                <button onclick="nav('leaderboard')" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-list-ol"></i> ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
                <button onclick="nav('schedule')" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-calendar-alt"></i> ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÅ‡∏Ç‡πà‡∏á</button>
                <button onclick="nav('daily')" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-star"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•/‡∏î‡∏≤‡∏ß‡∏ã‡∏±‡∏•‡πÇ‡∏ß</button>
                <button onclick="nav('stats')" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-chart-bar"></i> ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
                <button onclick="nav('teams')" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-shield-alt"></i> ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡∏°</button>
                <button onclick="nav('players')" class="nav-btn px-4 py-1.5 rounded-full text-sm whitespace-nowrap transition"><i class="fas fa-users"></i> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</button>
            </div>
        </div>
    </nav>

    <main class="flex-grow container mx-auto px-2 py-6 md:px-4">

        <div id="page-home" class="section fade-in">
            <div class="glass p-6 rounded-2xl mb-6">
                <h2 class="text-2xl font-extrabold text-yellow-400 mb-4 flex items-center gap-3">
                    <i class="fas fa-chart-line"></i> ‡∏™‡∏£‡∏∏‡∏õ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏•‡∏µ‡∏Å
                </h2>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 text-center">
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4 border-yellow-500">
                        <div class="text-3xl font-black" id="stat-total-teams">0</div>
                        <div class="text-gray-400 text-sm">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ó‡∏µ‡∏°</div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4 border-green-500">
                        <div class="text-3xl font-black" id="stat-total-matches">0</div>
                        <div class="text-gray-400 text-sm">‡πÅ‡∏°‡∏ó‡∏ä‡πå‡∏ó‡∏µ‡πà‡πÅ‡∏Ç‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4 border-red-500">
                        <div class="text-3xl font-black" id="stat-total-goals">0</div>
                        <div class="text-gray-400 text-sm">‡∏£‡∏ß‡∏°‡∏õ‡∏£‡∏∞‡∏ï‡∏π</div>
                    </div>
                    <div class="bg-gray-800 p-4 rounded-xl shadow-lg border-b-4 border-blue-500">
                        <div class="text-3xl font-black" id="stat-total-players">0</div>
                        <div class="text-gray-400 text-sm">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</div>
                    </div>
                </div>
            </div>

            <div class="glass p-6 rounded-2xl">
                <h2 class="text-2xl font-extrabold text-yellow-400 mb-4 flex items-center gap-3">
                    <i class="fas fa-user-tie"></i> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡∏°
                </h2>
                <div id="manager-list" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    </div>
            </div>
        </div>

        <div id="page-leaderboard" class="section hidden fade-in">
            <div class="glass p-3 rounded-xl mb-4 flex flex-wrap gap-4 items-center text-xs">
                <strong class="text-yellow-400">‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏ï‡πà‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á:</strong>
                <div><label>‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á</label><input type="color" id="lb-bg-body" value="#1e293b" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£</label><input type="color" id="lb-body-text-color" value="#ffffff" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div class="h-4 w-px bg-gray-600"></div>
                <div><label>‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á 1</label><input type="color" id="lb-header-grad-1" value="#1c365b" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á 2</label><input type="color" id="lb-header-grad-2" value="#0c1626" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á</label><input type="color" id="lb-header-text-color" value="#ffffff" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div class="h-4 w-px bg-gray-600"></div>
                <div><label>‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ï‡πâ‡∏° 1</label><input type="color" id="lb-pts-grad-1" value="#facc15" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
                <div><label>‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÅ‡∏ï‡πâ‡∏° 2</label><input type="color" id="lb-pts-grad-2" value="#e3a008" class="w-5 h-5 rounded align-middle ml-1 cursor-pointer" oninput="renderLeaderboard()"></div>
            </div>

            <div class="rounded-xl overflow-hidden shadow-2xl">
                <div id="lb-banner" class="p-6 text-center relative" style="background: linear-gradient(135deg, #1c365b, #0c1626);">
                    <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/carbon-fibre.png')] opacity-10"></div>
                    <h2 contenteditable="true" id="lb-title" class="relative text-3xl md:text-5xl font-extrabold uppercase italic outline-text tracking-wider z-10 focus:outline-none focus:border-b border-white" style="color: #facc15;">
                        ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô JAKHONG SENIOR CUP
                    </h2>
                </div>
                
                <div class="overflow-x-auto bg-gray-900">
                    <table class="w-full text-left border-collapse min-w-[700px]" id="lb-table">
                        <thead>
                            <tr class="uppercase text-sm tracking-wider border-b border-white/10" id="lb-thead-row">
                                <th class="p-4" style="color: #ffffff;">‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th>
                                <th class="p-4" style="color: #ffffff;">‡∏ó‡∏µ‡∏°</th>
                                <th class="p-4 text-center" style="color: #ffffff;">‡πÅ‡∏Ç‡πà‡∏á</th>
                                <th class="p-4 text-center" style="color: #ffffff;">‡∏ä‡∏ô‡∏∞</th>
                                <th class="p-4 text-center" style="color: #ffffff;">‡πÄ‡∏™‡∏°‡∏≠</th>
                                <th class="p-4 text-center" style="color: #ffffff;">‡πÅ‡∏û‡πâ</th>
                                <th class="p-4 text-center" style="color: #ffffff;">‡πÑ‡∏î‡πâ/‡πÄ‡∏™‡∏µ‡∏¢</th>
                                <th class="p-4 text-center" style="color: #ffffff;">+/-</th>
                                <th class="p-0 text-center text-xl">
                                    <div style="background: linear-gradient(135deg, #facc15, #e3a008); color: black;" class="font-black">‡πÅ‡∏ï‡πâ‡∏°</div>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="lb-body" class="text-base font-medium"></tbody>
                    </table>
                </div>
            </div>
        </div>

        <div id="page-schedule" class="section hidden fade-in">
            <div class="glass p-3 rounded-xl mb-4 flex flex-wrap gap-4 items-center text-xs">
                <button onclick="openAddSchedModal()" class="bg-green-600 text-white px-3 py-1 rounded font-bold hover:bg-green-500 transition">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÅ‡∏°‡∏ó‡∏ä‡πå</button>
                <div class="h-4 w-px bg-gray-600"></div>
                <label>‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á:</label>
                <input type="color" id="sc-bg-color" value="#1c365b" class="w-5 h-5 rounded cursor-pointer" oninput="renderSchedule()">
                <label>‡∏™‡∏µ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£:</label>
                <input type="color" id="sc-text-color" value="#ffffff" class="w-5 h-5 rounded cursor-pointer" oninput="renderSchedule()">
                <label>‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠:</label>
                <input type="color" id="sc-pill-color" value="#facc15" class="w-5 h-5 rounded cursor-pointer" oninput="renderSchedule()">
                <input type="text" id="sc-header-text" value="‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô" class="bg-gray-700 text-white px-2 rounded w-32" oninput="renderSchedule()">
            </div>

            <div class="flex flex-col min-h-[500px] rounded-xl overflow-hidden shadow-2xl relative bg-gray-900">
                <div class="flex-1 p-4 md:p-8 relative z-10 w-full" id="sc-container">
                    <div class="text-center mb-8">
                        <span id="sc-pill" class="inline-block px-8 py-2 rounded-full text-xl md:text-2xl font-bold uppercase shadow-lg bg-yellow-400 text-black mb-2 transform skew-x-[-10deg]">
                            ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô
                        </span>
                    </div>

                    <div class="flex gap-3 justify-center mb-6 overflow-x-auto no-scrollbar">
                        <button onclick="setGroupFilter('All', this)" class="group-tab active bg-yellow-500 text-black px-4 py-1 rounded-full text-sm font-bold transition hover:bg-yellow-600">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                        <button onclick="setGroupFilter('A', this)" class="group-tab bg-gray-700 text-white px-4 py-1 rounded-full text-sm font-medium transition hover:bg-gray-600">‡∏Å‡∏•‡∏∏‡πà‡∏° A</button>
                        <button onclick="setGroupFilter('B', this)" class="group-tab bg-gray-700 text-white px-4 py-1 rounded-full text-sm font-medium transition hover:bg-gray-600">‡∏Å‡∏•‡∏∏‡πà‡∏° B</button>
                        </div>
                    
                    <div id="sched-list" class="space-y-4 max-w-4xl mx-auto">
                        </div>
                </div>

                <div id="sc-bg-overlay" class="absolute inset-0 z-0 bg-gradient-to-br from-blue-900 to-black opacity-90"></div>
            </div>
        </div>

        <div id="page-daily" class="section hidden fade-in">
            <div class="glass p-4 rounded-xl mb-6 flex flex-wrap gap-6 items-end">
                <div>
                    <label class="text-xs text-gray-400 block mb-1">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà</label>
                    <input type="date" id="daily-date" class="bg-black border border-gray-600 p-2 rounded text-white text-sm w-full" onchange="renderDaily()">
                </div>
                <div class="flex gap-2">
                    <div><label class="text-xs text-gray-400 block mb-1">‡∏™‡∏µ‡∏™‡∏Å‡∏≠‡∏£‡πå</label><input type="color" id="daily-score-color" value="#facc15" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡πÅ‡∏ñ‡∏ö 1</label><input type="color" id="daily-row-bg-1" value="#1f2937" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡πÅ‡∏ñ‡∏ö 2</label><input type="color" id="daily-row-bg-2" value="#0c1626" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                </div>
                <div class="flex gap-2">
                    <div><label class="text-xs text-gray-400 block mb-1">‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå 1</label><input type="color" id="daily-banner-grad-1" value="#1c365b" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå 2</label><input type="color" id="daily-banner-grad-2" value="#0c1626" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">‡∏≠‡∏±‡∏Å‡∏©‡∏£‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå</label><input type="color" id="daily-banner-text" value="#facc15" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                    <div><label class="text-xs text-gray-400 block mb-1">‡∏Ç‡∏≠‡∏ö‡πÅ‡∏ö‡∏ô‡πÄ‡∏ô‡∏≠‡∏£‡πå</label><input type="color" id="daily-banner-border" value="#facc15" class="w-8 h-8 rounded cursor-pointer" oninput="renderDaily()"></div>
                </div>
            </div>

            <div id="daily-preview" class="bg-white max-w-[900px] mx-auto shadow-2xl overflow-hidden pb-10 rounded-xl">
                
                <div id="daily-header" class="py-4 px-4 flex flex-wrap items-center justify-between relative border-b-4 border-yellow-500">
                    <div class="flex items-center gap-3 z-10">
                        <img id="daily-logo-img" src="" class="w-12 h-12 object-contain drop-shadow-md bg-white rounded-full p-1 border border-yellow-400">
                        <div contenteditable="true" id="daily-title-edit" class="text-xl md:text-3xl font-extrabold uppercase italic leading-none outline-text text-yellow-400" style="text-shadow: 2px 2px 0 #000;">
                            ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô 24/11/2568 JAKHONG LEAGUE 3
                        </div>
                    </div>
                </div>

                <div class="p-4 md:p-8 bg-gray-900 min-h-[200px] space-y-3" id="daily-matches-container"></div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-0 border-t-4 border-black mt-4">
                    
                    <div class="md:col-span-1 bg-gray-800 p-4 border-r border-gray-700 flex flex-col">
                        <h3 class="text-center font-bold text-yellow-400 uppercase text-base mb-4 border-b border-gray-700 pb-2">
                            ‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏¢‡∏¥‡∏á‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (‡∏î‡∏≤‡∏ß‡∏ã‡∏±‡∏•‡πÇ‡∏ß)
                        </h3>
                        <div id="daily-top-scorers" class="space-y-3 overflow-y-auto max-h-[500px] pr-1 custom-scrollbar"></div>
                    </div>

                    <div class="md:col-span-2 bg-gradient-to-br from-gray-900 to-black p-4">
                        <h3 class="text-center font-bold text-green-400 uppercase text-base mb-4 border-b border-gray-700 pb-2">
                            ‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏õ‡∏£‡∏∞‡∏ï‡∏π‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ
                        </h3>
                        <div id="daily-today-scorers" class="grid grid-cols-3 sm:grid-cols-4 gap-3"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-stats" class="section hidden fade-in">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <div class="glass p-6 rounded-2xl h-fit">
                    <h2 class="text-xl font-bold mb-4 text-yellow-400">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥ / ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á</h2>
                    <div class="mb-6 p-4 bg-white/5 rounded-xl border border-white/10">
                        <h3 class="text-sm font-bold text-gray-400 mb-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏ú‡∏•‡∏™‡∏Å‡∏≠‡∏£‡πå</h3>
                        <form onsubmit="handleMatchSubmit(event)" class="flex gap-2 items-center">
                            <input type="hidden" id="match-edit-id">
                            <input type="date" id="match-date" class="bg-gray-800 p-2 rounded text-white w-1/3 text-xs" required>
                            <select id="m-team-a" class="flex-1 bg-gray-800 p-2 rounded text-xs" required></select>
                            <input type="number" id="m-score-a" class="w-12 bg-black p-2 rounded text-center font-bold border border-yellow-500" min="0" value="0">
                            <span class="text-xs">VS</span>
                            <input type="number" id="m-score-b" class="w-12 bg-black p-2 rounded text-center font-bold border border-yellow-500" min="0" value="0">
                            <select id="m-team-b" class="flex-1 bg-gray-800 p-2 rounded text-xs" required></select>
                            <button type="submit" id="btn-match-save" class="bg-blue-600 px-3 py-2 rounded hover:bg-blue-500 transition"><i class="fas fa-save"></i></button>
                        </form>
                    </div>

                    <div class="p-4 bg-white/5 rounded-xl border border-white/10">
                        <h3 class="text-sm font-bold text-gray-400 mb-2">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏£‡∏≤‡∏¢‡∏Ñ‡∏ô</h3>
                        <form onsubmit="handleStatSubmit(event)" class="space-y-4">
                            <input type="hidden" id="edit-stat-id">
                            <div class="flex gap-2">
                                <input type="date" id="s-date" class="bg-gray-800 p-2 rounded text-white w-1/3 text-xs" required>
                                <select id="s-type" class="bg-gray-800 p-2 rounded text-white flex-1 text-xs">
                                    <option value="goal">‚öΩ ‡∏õ‡∏£‡∏∞‡∏ï‡∏π</option>
                                    <option value="yellow">üü® ‡πÉ‡∏ö‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏á</option>
                                    <option value="red">üü• ‡πÉ‡∏ö‡πÅ‡∏î‡∏á</option>
                                    <option value="save">üß§ ‡πÄ‡∏ã‡∏ü</option>
                                </select>
                            </div>
                            <select id="s-team" class="w-full bg-gray-800 p-2 rounded text-white text-sm" onchange="updateStatPlayers()" required><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°</option></select>
                            <select id="s-player" class="w-full bg-gray-800 p-2 rounded text-white text-sm" required><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</option></select>
                            
                            <div class="flex items-center gap-3 bg-gray-900 p-2 rounded">
                                <button type="button" onclick="adjStat(-1)" class="w-8 h-8 bg-gray-700 rounded hover:bg-red-500 transition">-</button>
                                <input type="number" id="s-count" value="1" class="bg-transparent text-center w-10 font-bold" min="1">
                                <button type="button" onclick="adjStat(1)" class="w-8 h-8 bg-gray-700 rounded hover:bg-green-500 transition">+</button>
                                <input type="text" id="s-note" placeholder="‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏..." class="flex-1 bg-transparent border-b border-gray-600 text-xs px-2">
                            </div>

                            <div class="flex gap-2">
                                <button type="submit" id="btn-stat-save" class="flex-1 bg-yellow-500 text-black py-2 rounded font-bold hover:bg-yellow-400 transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                                <button type="button" onclick="resetStatForm()" id="btn-stat-cancel" class="hidden px-3 bg-gray-600 rounded">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="glass p-6 rounded-2xl h-[600px] overflow-hidden flex flex-col">
                    <h2 class="text-xl font-bold mb-4 text-yellow-400">‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç/‡∏•‡∏ö)</h2>
                    
                    <div class="flex mb-4 border-b border-gray-700">
                        <button onclick="showHistory('match', this)" id="hist-tab-match" class="hist-tab px-4 py-2 text-sm font-bold text-yellow-400 border-b-2 border-yellow-400">‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</button>
                        <button onclick="showHistory('stat', this)" id="hist-tab-stat" class="hist-tab px-4 py-2 text-sm font-bold text-gray-400 hover:text-white">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ú‡∏π‡πâ‡πÄ‡∏•‡πà‡∏ô</button>
                    </div>

                    <div class="overflow-y-auto pr-2 space-y-2 flex-1 custom-scrollbar">
                        <div id="history-match-list" class="space-y-2"></div>
                        <div id="history-stat-list" class="space-y-2 hidden"></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="page-teams" class="section hidden fade-in">
            <div class="glass p-6 rounded-2xl mb-8">
                <h2 class="text-xl font-bold mb-4 text-yellow-400">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡∏°</h2>
                <form onsubmit="handleTeamSubmit(event)" class="flex flex-wrap gap-4 items-end">
                    <input type="hidden" id="team-edit-id">
                    <div class="flex-1 min-w-[200px]">
                        <label class="text-xs text-gray-400">‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°</label>
                        <input type="text" id="team-name" class="w-full bg-gray-800 p-2 rounded border border-gray-600" required>
                    </div>
                    <div>
                        <label class="text-xs text-gray-400">‡∏™‡∏µ‡∏ó‡∏µ‡∏° (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ)</label>
                        <input type="color" id="team-color" class="w-10 h-10 rounded cursor-pointer block mt-1">
                    </div>
                    <div class="flex-1 min-w-[200px]">
                        <label class="text-xs text-gray-400">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ (‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î)</label>
                        <input type="tel" id="team-tel" class="w-full bg-gray-800 p-2 rounded border border-gray-600" placeholder="0xx-xxx-xxxx">
                    </div>
                    <div class="flex-1 min-w-[200px]">
                        <label class="text-xs text-gray-400">‡πÇ‡∏•‡πÇ‡∏Å‡πâ (‡∏Å‡∏£‡∏≠‡∏ö‡∏Å‡∏•‡∏°‡πÉ‡∏´‡∏ç‡πà)</label>
                        <input type="file" id="team-logo" accept="image/*" class="w-full text-xs mt-1">
                    </div>
                    <button type="submit" id="btn-team-save" class="bg-yellow-500 text-black px-6 py-2 rounded font-bold hover:bg-yellow-400 h-10 transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                    <button type="button" onclick="resetTeamForm()" id="btn-team-cancel" class="bg-gray-600 px-6 py-2 rounded font-bold h-10 hidden">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                </form>
            </div>
            <div id="team-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"></div>
        </div>

        <div id="page-players" class="section hidden fade-in">
            <div class="mb-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-2xl font-bold italic uppercase text-yellow-400">‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</h2>
                    <button onclick="openPlayerModal()" class="bg-green-600 px-4 py-2 rounded font-bold hover:bg-green-500 transition">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</button>
                </div>
                <div class="flex gap-2 mb-4 overflow-x-auto no-scrollbar" id="player-team-tabs"></div>
                
                <div id="player-team-banner" class="hidden p-6 rounded-xl mb-6 shadow-xl flex items-center gap-6 border-l-8" style="background: linear-gradient(135deg, #1c365b 0%, #0c1626 100%); border-color: #facc15;">
                    <img id="ptb-logo" class="w-24 h-24 rounded-full object-cover border-4 border-yellow-400 shadow-md">
                    <div>
                        <h2 id="ptb-name" class="text-4xl font-extrabold uppercase italic text-white">TEAM NAME</h2>
                        <div class="text-xl font-semibold text-yellow-400 mt-1">‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å: <span id="ptb-member-count">0</span> ‡∏Ñ‡∏ô</div>
                    </div>
                    <input type="color" id="ptb-color-picker" class="hidden" oninput="updateTeamColorLive(this)">
                </div>
            </div>
            <div id="player-grid" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4"></div>
        </div>

    </main>

    <div id="sched-modal" class="fixed inset-0 bg-black/90 hidden z-50 flex items-center justify-center">
        <div class="glass p-6 rounded-xl w-full max-w-md">
            <h3 class="text-xl font-bold mb-4 text-yellow-400">‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡πÅ‡∏Ç‡πà‡∏á</h3>
            <form onsubmit="handleSchedSubmit(event)" class="space-y-4">
                <input type="date" id="sc-date" class="w-full bg-gray-800 p-2 rounded" required>
                <input type="time" id="sc-time" class="w-full bg-gray-800 p-2 rounded" required>
                <input type="number" id="sc-week" placeholder="Week ‡∏ó‡∏µ‡πà (‡πÄ‡∏ä‡πà‡∏ô 1, 2)" class="w-full bg-gray-800 p-2 rounded" min="1" required> <div class="flex gap-2">
                    <select id="sc-team-a" class="flex-1 bg-gray-800 p-2 rounded" required></select>
                    <span class="text-gray-400">VS</span>
                    <select id="sc-team-b" class="flex-1 bg-gray-800 p-2 rounded" required></select>
                </div>
                <select id="sc-group" class="w-full bg-gray-800 p-2 rounded">
                    <option value="">‡∏Å‡∏•‡∏∏‡πà‡∏° (‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏)</option>
                    <option value="A">‡∏Å‡∏•‡∏∏‡πà‡∏° A</option>
                    <option value="B">‡∏Å‡∏•‡∏∏‡πà‡∏° B</option>
                    <option value="C">‡∏Å‡∏•‡∏∏‡πà‡∏° C</option>
                    <option value="D">‡∏Å‡∏•‡∏∏‡πà‡∏° D</option>
                </select>
                <button class="w-full bg-yellow-500 text-black py-2 rounded font-bold hover:bg-yellow-400 transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                <button type="button" onclick="document.getElementById('sched-modal').classList.add('hidden')" class="w-full bg-gray-600 py-2 rounded mt-2">‡∏õ‡∏¥‡∏î</button>
            </form>
        </div>
    </div>

    <div id="player-modal" class="fixed inset-0 bg-black/90 hidden z-50 flex items-center justify-center">
        <div class="glass p-6 rounded-xl w-full max-w-md">
            <h3 id="player-modal-title" class="text-xl font-bold mb-4 text-yellow-400">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</h3>
            <form onsubmit="handlePlayerSubmit(event)" class="space-y-3">
                <input type="hidden" id="p-id">
                <input type="text" id="p-name" placeholder="‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" class="w-full bg-gray-800 p-2 rounded" required>
                <div class="flex gap-2">
                    <input type="text" id="p-no" placeholder="‡πÄ‡∏ö‡∏≠‡∏£‡πå" class="w-20 bg-gray-800 p-2 rounded">
                    <select id="p-team" class="flex-1 bg-gray-800 p-2 rounded" required></select>
                </div>
                <label class="flex gap-2 text-sm items-center"><input type="checkbox" id="p-manager" class="w-4 h-4 text-yellow-500 bg-gray-700 border-gray-600 rounded focus:ring-yellow-500"> ‡πÄ‡∏õ‡πá‡∏ô‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡∏°</label>
                <input type="file" id="p-img" accept="image/*" class="w-full text-xs text-gray-400">
                <p class="text-[10px] text-gray-500 mt-1">
                    *‡∏†‡∏≤‡∏û‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏•‡∏∞‡∏Ñ‡∏£‡∏≠‡∏ö‡∏ï‡∏±‡∏î‡πÄ‡∏õ‡πá‡∏ô‡∏™‡∏±‡∏î‡∏™‡πà‡∏ß‡∏ô 3:4 ‡πÇ‡∏î‡∏¢‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏û‡∏≠‡∏î‡∏µ‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πå‡∏î
                </p>
                <button type="submit" id="btn-player-save" class="w-full bg-green-600 py-2 rounded font-bold hover:bg-green-500 transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
                <button type="button" onclick="closePlayerModal()" class="w-full bg-gray-600 py-2 rounded mt-2">‡∏õ‡∏¥‡∏î</button>
            </form>
        </div>
    </div>

    <div id="settings-modal" class="fixed inset-0 bg-black/90 hidden z-[60] flex items-center justify-center">
        <div class="glass p-6 rounded-xl w-full max-w-sm text-center">
            <h2 class="text-xl font-bold mb-4 text-yellow-400">‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏•‡∏µ‡∏Å</h2>
            <input type="file" id="global-logo-upload" accept="image/*" class="w-full text-sm text-gray-400 mb-4">
            <button onclick="saveGlobalLogo()" class="bg-yellow-500 text-black px-4 py-2 rounded font-bold hover:bg-yellow-400 transition">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
            <button onclick="toggleSettings()" class="mt-2 text-gray-400 text-sm underline block w-full">‡∏õ‡∏¥‡∏î</button>
        </div>
    </div>

    <script>
        // --- STATE ---
        let teams = JSON.parse(localStorage.getItem('jl_teams')) || [];
        let players = JSON.parse(localStorage.getItem('jl_players')) || [];
        let matches = JSON.parse(localStorage.getItem('jl_matches')) || [];
        let stats = JSON.parse(localStorage.getItem('jl_stats')) || [];
        let schedules = JSON.parse(localStorage.getItem('jl_schedules')) || [];
        let globalLogo = localStorage.getItem('jl_logo') || ""; 
        let currentGroupFilter = 'All'; 
        let currentTeamView = 'all';

        const save = () => {
            localStorage.setItem('jl_teams', JSON.stringify(teams));
            localStorage.setItem('jl_players', JSON.stringify(players));
            localStorage.setItem('jl_matches', JSON.stringify(matches));
            localStorage.setItem('jl_stats', JSON.stringify(stats));
            localStorage.setItem('jl_schedules', JSON.stringify(schedules));
            localStorage.setItem('jl_logo', globalLogo);
            renderAll();
        }

        const compressImage = (file) => {
            return new Promise((resolve) => {
                const reader = new FileReader();
                reader.readAsDataURL(file);
                reader.onload = (e) => {
                    const img = new Image();
                    img.src = e.target.result;
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        const targetWidth = 300;
                        const targetHeight = 400; // Force 3:4 aspect ratio

                        // Calculate scale to ensure the image covers the container (object-fit: cover logic)
                        const scale = Math.max(targetWidth / img.width, targetHeight / img.height);
                        const x = (targetWidth / 2) - (img.width / 2) * scale;
                        const y = (targetHeight / 2) - (img.height / 2) * scale;

                        canvas.width = targetWidth;
                        canvas.height = targetHeight;
                        
                        ctx.drawImage(img, x, y, img.width * scale, img.height * scale);
                        
                        resolve(canvas.toDataURL('image/jpeg', 0.8));
                    }
                }
            });
        }

        const formatDate = (d) => {
            if(!d) return '';
            return new Date(d).toLocaleDateString('th-TH', {day:'2-digit', month:'2-digit', year:'numeric'});
        }

        window.onload = () => {
            const today = new Date().toISOString().split('T')[0];
            document.querySelectorAll('input[type="date"]').forEach(i => i.value = today);
            if(globalLogo) document.getElementById('daily-logo-img').src = globalLogo;
            renderAll();
            nav('home', document.querySelector('.nav-btn'));
        }

        function nav(id, button) {
            document.querySelectorAll('.section').forEach(el => el.classList.add('hidden'));
            document.getElementById('page-'+id).classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            if(button) button.classList.add('active');

            // Trigger specific renders
            if(id === 'home') renderDashboard();
            if(id === 'daily') renderDaily();
            if(id === 'leaderboard') renderLeaderboard();
            if(id === 'stats') {
                renderHistoryLog('match'); 
                document.getElementById('hist-tab-match').click();
            }
        }

        function renderAll() {
            updateDropdowns();
            renderLeaderboard();
            renderSchedule();
            renderTeams();
            renderPlayers(currentTeamView);
            renderHistoryLog('match'); 
            renderHistoryLog('stat'); 
            renderDashboard(); // Update dashboard stats
        }

        function updateDropdowns() {
            const opts = `<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ó‡∏µ‡∏°</option>` + teams.map(t => `<option value="${t.id}">${t.name}</option>`).join('');
            ['sc-team-a','sc-team-b','m-team-a','m-team-b','s-team','p-team'].forEach(id => {
                const el = document.getElementById(id);
                if(el) el.innerHTML = opts;
            });
        }

        // --- 0. DASHBOARD ---
        function renderDashboard() {
            // General Stats
            document.getElementById('stat-total-teams').innerText = teams.length;
            // stat-total-matches is intentionally kept as the count of completed matches
            document.getElementById('stat-total-matches').innerText = matches.length; 
            document.getElementById('stat-total-players').innerText = players.length;
            
            const totalGoals = stats.filter(s => s.type === 'goal').reduce((sum, s) => sum + s.count, 0);
            document.getElementById('stat-total-goals').innerText = totalGoals;

            // Manager List
            const managers = players.filter(p => p.manager).map(p => {
                const team = teams.find(t => t.id == p.teamId);
                return {
                    ...p,
                    teamName: team?.name || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ó‡∏µ‡∏°',
                    teamColor: team?.color || '#374151',
                    teamTel: team?.tel || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£'
                }
            });

            document.getElementById('manager-list').innerHTML = managers.map(m => `
                <div class="bg-gray-800 p-4 rounded-xl shadow-md border-l-4" style="border-color: ${m.teamColor};">
                    <div class="flex items-center gap-3 mb-2">
                        <img src="${m.img||''}" class="w-12 h-12 logo-circle bg-white p-0.5 border-2" style="border-color: ${m.teamColor}">
                        <div>
                            <div class="font-bold text-lg">${m.name}</div>
                            <div class="text-xs text-gray-400">${m.teamName}</div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2 text-sm mt-2">
                        <i class="fas fa-phone-alt text-yellow-400"></i>
                        <span class="text-white">${m.teamTel}</span>
                    </div>
                </div>
            `).join('');

            // If no managers were assigned using the checkbox, try to find a phone number from team data
            if(managers.length === 0 && teams.length > 0) {
                 document.getElementById('manager-list').innerHTML = teams.filter(t => t.tel).map(t => `
                    <div class="bg-gray-800 p-4 rounded-xl shadow-md border-l-4" style="border-color: ${t.color};">
                        <div class="flex items-center gap-3 mb-2">
                            <img src="${t.logo||''}" class="w-12 h-12 logo-circle bg-white p-0.5 border-2" style="border-color: ${t.color}">
                            <div>
                                <div class="font-bold text-lg">${t.name}</div>
                                <div class="text-xs text-gray-400">‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏µ‡∏° (‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠)</div>
                            </div>
                        </div>
                        <div class="flex items-center gap-2 text-sm mt-2">
                            <i class="fas fa-phone-alt text-yellow-400"></i>
                            <span class="text-white">${t.tel}</span>
                        </div>
                    </div>
                `).join('');
            }
        }

        // --- 1. LEADERBOARD ---
        function renderLeaderboard() {
            // NEW Controls
            const bodyTx = document.getElementById('lb-body-text-color').value;
            const bg = document.getElementById('lb-bg-body').value;
            const headerGrad1 = document.getElementById('lb-header-grad-1').value;
            const headerGrad2 = document.getElementById('lb-header-grad-2').value;
            const ptsGrad1 = document.getElementById('lb-pts-grad-1').value;
            const ptsGrad2 = document.getElementById('lb-pts-grad-2').value;
            const headerTx = document.getElementById('lb-header-text-color').value;

            // Apply Header Background Gradient to Banner and Table Header
            const banner = document.getElementById('lb-banner');
            banner.style.background = `linear-gradient(135deg, ${headerGrad1}, ${headerGrad2})`;
            document.getElementById('lb-title').style.color = headerTx;

            const thead = document.getElementById('lb-table').querySelector('thead');
            thead.style.background = `linear-gradient(135deg, ${headerGrad1}, ${headerGrad2})`;
            
            // Set dynamic colors for the fixed part of the header
            document.getElementById('lb-thead-row').querySelectorAll('th').forEach((th, index) => {
                th.style.color = headerTx; 
                // Target the Points column header for special gradient
                if (index === 8) {
                    const div = th.querySelector('div');
                    div.style.background = `linear-gradient(135deg, ${ptsGrad1}, ${ptsGrad2})`;
                    div.style.color = 'black'; // Keep text dark for contrast on bright gradient
                } else {
                    th.style.background = 'transparent'; // Use parent thead background
                }
            });
            
            // Apply body styles
            const tbody = document.getElementById('lb-body');
            tbody.parentElement.style.backgroundColor = bg; 
            tbody.style.color = bodyTx; // All body text/numbers

            // Calculate
            const data = teams.map(t => {
                let p=0, w=0, d=0, l=0, gf=0, ga=0;
                matches.forEach(m => {
                    if(m.teamA == t.id) { p++; gf+=Number(m.scoreA); ga+=Number(m.scoreB); if(Number(m.scoreA) > Number(m.scoreB)) w++; else if(Number(m.scoreA)==Number(m.scoreB))d++; else l++; }
                    if(m.teamB == t.id) { p++; gf+=Number(m.scoreB); ga+=Number(m.scoreA); if(Number(m.scoreB) > Number(m.scoreA)) w++; else if(Number(m.scoreB)==Number(m.scoreA))d++; else l++; }
                });
                return { ...t, p, w, d, l, gf, ga, gd: gf-ga, pts: (w*3)+d };
            }).sort((a,b) => b.pts - a.pts || b.gd - a.gd || b.gf - a.gf);

            tbody.innerHTML = data.map((d, i) => {
                // Apply body styles to all cells except the '‡πÅ‡∏ï‡πâ‡∏°' column
                const baseStyle = `background-color: ${bg}; color: ${bodyTx};`;
                // Use a solid color for the points column body for visual tie-in with the gradient
                const ptsStyle = `background: ${ptsGrad1}; color: black; font-weight: 900;`; 
                
                return `
                <tr style="${baseStyle}">
                    <td class="p-4 font-black rounded-l-lg" style="color: ${bodyTx}">${i+1}</td>
                    <td class="p-4 flex items-center gap-3">
                        <img src="${d.logo || ''}" class="w-10 h-10 logo-circle bg-white p-0.5">
                        <span class="font-bold uppercase">${d.name}</span>
                    </td>
                    <td class="p-4 text-center opacity-70" style="color: ${bodyTx}">${d.p}</td>
                    <td class="p-4 text-center text-green-400 font-bold" style="color: ${bodyTx}">${d.w}</td>
                    <td class="p-4 text-center opacity-70" style="color: ${bodyTx}">${d.d}</td>
                    <td class="p-4 text-center text-red-400 font-bold" style="color: ${bodyTx}">${d.l}</td>
                    <td class="p-4 text-center opacity-70 text-sm" style="color: ${bodyTx}">${d.gf}/${d.ga}</td>
                    <td class="p-4 text-center font-bold" style="color: ${bodyTx}">${d.gd>0?'+'+d.gd:d.gd}</td>
                    <td class="p-4 text-center font-black text-xl rounded-r-lg" style="${ptsStyle}">${d.pts}</td>
                </tr>
            `}).join('');
        }

        // --- 2. SCHEDULE ---
        function openAddSchedModal() { document.getElementById('sched-modal').classList.remove('hidden'); }
        function handleSchedSubmit(e) {
            e.preventDefault();
            schedules.push({
                id: Date.now(),
                date: document.getElementById('sc-date').value,
                time: document.getElementById('sc-time').value,
                week: document.getElementById('sc-week').value, // NEW
                teamA: document.getElementById('sc-team-a').value,
                teamB: document.getElementById('sc-team-b').value,
                group: document.getElementById('sc-group').value || null 
            });
            save();
            document.getElementById('sched-modal').classList.add('hidden');
            e.target.reset();
        }
        function setGroupFilter(group, button) {
            currentGroupFilter = group;
            // Update button styles
            document.querySelectorAll('.group-tab').forEach(btn => {
                btn.classList.remove('bg-yellow-500', 'text-black', 'active');
                btn.classList.add('bg-gray-700', 'text-white');
            });
            if (button) {
                button.classList.add('bg-yellow-500', 'text-black', 'active');
                button.classList.remove('bg-gray-700', 'text-white');
            }
            renderSchedule();
        }
        function renderSchedule() {
            const bg = document.getElementById('sc-bg-color').value;
            const tx = document.getElementById('sc-text-color').value;
            const txt = document.getElementById('sc-header-text').value;
            const pillColor = document.getElementById('sc-pill-color').value; // NEW

            document.getElementById('sc-bg-overlay').style.background = `linear-gradient(135deg, ${bg}, #000)`;
            document.getElementById('sc-pill').textContent = txt;
            document.getElementById('sc-pill').style.backgroundColor = pillColor; // NEW
            document.getElementById('sc-container').style.color = tx;

            let filteredSchedules = schedules.filter(s => 
                currentGroupFilter === 'All' || s.group === currentGroupFilter
            );

            // Group by Week first
            const groupedByWeek = filteredSchedules.sort((a,b)=> a.week - b.week || new Date(a.date+'T'+a.time) - new Date(b.date+'T'+b.time)).reduce((acc, s) => {
                const weekKey = s.week;
                if (!acc[weekKey]) acc[weekKey] = {};
                
                // Group by Date second
                const dateKey = s.date;
                if (!acc[weekKey][dateKey]) acc[weekKey][dateKey] = [];
                acc[weekKey][dateKey].push(s);
                return acc;
            }, {});

            const div = document.getElementById('sched-list');
            let htmlContent = '';
            
            // Render groups
            Object.keys(groupedByWeek).forEach(weekKey => {
                const weekData = groupedByWeek[weekKey];

                htmlContent += `<div class="schedule-group-header" style="background-color: ${pillColor};">WEEK ${weekKey}</div>`;
                
                Object.keys(weekData).forEach(dateKey => {
                    const daySchedules = weekData[dateKey];
                    
                    // Add Date Header
                    htmlContent += `<div class="text-center font-bold text-lg mt-4 mb-2 text-yellow-400 border-b border-gray-700 pb-1">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: ${formatDate(dateKey)}</div>`;

                    // Add individual match cards
                    htmlContent += daySchedules.map(s => {
                        const t1 = teams.find(x => x.id == s.teamA);
                        const t2 = teams.find(x => x.id == s.teamB);
                        const groupTag = s.group ? `<span class="text-xs font-bold text-black bg-yellow-400 px-2 py-0.5 rounded-full absolute top-1 left-1">${s.group}</span>` : '';

                        return `
                        <div class="schedule-card p-3 rounded-xl flex items-center relative group bg-gray-800 shadow-md">
                            ${groupTag}
                            <button onclick="delSched(${s.id})" class="absolute -top-2 -right-2 bg-red-600 w-6 h-6 rounded-full text-xs opacity-0 group-hover:opacity-100 transition z-20"><i class="fas fa-trash"></i></button>
                            <div class="w-20 text-center border-r border-white/20 pr-2 mr-2">
                                <div class="text-xs opacity-70">${s.date.substring(5, 7)}/${s.date.substring(8, 10)}</div>
                                <div class="text-xl font-black">${s.time}</div>
                            </div>
                            <div class="flex-1 flex justify-between items-center px-2">
                                <div class="flex flex-col items-center w-1/3">
                                    <img src="${t1?.logo||''}" class="w-12 h-12 logo-circle bg-white p-0.5 mb-1 border-2 border-yellow-400">
                                    <span class="text-xs font-bold uppercase text-center leading-tight">${t1?.name||'?'}</span>
                                </div>
                                <div class="text-2xl font-black opacity-50 italic">VS</div>
                                <div class="flex flex-col items-center w-1/3">
                                    <img src="${t2?.logo||''}" class="w-12 h-12 logo-circle bg-white p-0.5 mb-1 border-2 border-yellow-400">
                                    <span class="text-xs font-bold uppercase text-center leading-tight">${t2?.name||'?'}</span>
                                </div>
                            </div>
                        </div>`;
                    }).join('');
                });
            });

            div.innerHTML = htmlContent;
        }
        function delSched(id) { if(confirm('‡∏•‡∏ö‡πÅ‡∏°‡∏ó‡∏ä‡πå‡∏ô‡∏µ‡πâ?')) { schedules = schedules.filter(s => s.id != id); save(); }}

        // --- 3. DAILY SUMMARY ---
        function renderDaily() {
            const date = document.getElementById('daily-date').value;
            const cSc = document.getElementById('daily-score-color').value;
            const cBg1 = document.getElementById('daily-row-bg-1').value;
            const cBg2 = document.getElementById('daily-row-bg-2').value;

            // NEW Banner Styles
            const cGrad1 = document.getElementById('daily-banner-grad-1').value;
            const cGrad2 = document.getElementById('daily-banner-grad-2').value;
            const cText = document.getElementById('daily-banner-text').value;
            const cBorder = document.getElementById('daily-banner-border').value;

            // 1. Banner Styles 
            const headerEl = document.getElementById('daily-header');
            headerEl.style.background = `linear-gradient(to right, ${cGrad1}, ${cGrad2})`;
            headerEl.style.borderColor = cBorder;
            document.getElementById('daily-title-edit').style.color = cText;
            document.getElementById('daily-logo-img').style.borderColor = cBorder;

            // 2. Matches List (Dark/Yellow theme)
            const list = matches.filter(m => m.date === date);
            const cont = document.getElementById('daily-matches-container');
            cont.innerHTML = list.map((m, i) => {
                const t1 = teams.find(x => x.id == m.teamA);
                const t2 = teams.find(x => x.id == m.teamB);
                const styleBg = i % 2 === 0 ? cBg1 : cBg2;
                
                return `
                <div style="background-color: ${styleBg};" class="rounded-lg p-3 flex items-center shadow-lg h-20 relative overflow-hidden border border-yellow-400/50">
                    <div class="flex items-center w-[40%] pl-2 gap-3">
                        <img src="${t1?.logo||''}" class="w-14 h-14 logo-circle bg-white border border-yellow-400 p-0.5">
                        <span class="font-bold text-sm leading-tight">${t1?.name}</span>
                    </div>
                    <div class="w-[20%] flex justify-center items-center text-3xl font-black tracking-tighter" style="color: ${cSc}">
                        ${m.scoreA} <span class="text-sm font-normal mx-1 opacity-50 text-white">:</span> ${m.scoreB}
                    </div>
                    <div class="flex items-center w-[40%] justify-end pr-2 gap-3">
                        <span class="font-bold text-sm leading-tight text-right">${t2?.name}</span>
                        <img src="${t2?.logo||''}" class="w-14 h-14 logo-circle bg-white p-0.5 border-2 border-yellow-400">
                    </div>
                </div>`;
            }).join('');

            // 3. Top Scorers (Vertical Cards)
            const counts = {};
            stats.filter(s => s.type === 'goal').forEach(s => counts[s.playerId] = (counts[s.playerId]||0) + s.count);
            const sorted = Object.entries(counts).sort((a,b) => b[1] - a[1]).slice(0, 10);
            
            document.getElementById('daily-top-scorers').innerHTML = sorted.map(([pid, c], i) => {
                const p = players.find(x => x.id == pid);
                const t = teams.find(x => x.id == p?.teamId);
                return `
                <div class="flex items-center gap-3 mb-3 bg-black/30 p-2 rounded border border-gray-600">
                    <div class="relative">
                        <img src="${p?.img||''}" class="w-12 h-14 object-cover rounded bg-gray-800 block">
                        <div class="absolute -top-1 -left-1 w-5 h-5 bg-yellow-500 text-black text-xs font-bold flex items-center justify-center rounded-full border border-white">${i+1}</div>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="text-white font-bold text-sm truncate">${p?.name}</div>
                        <div class="text-gray-400 text-xs truncate">${t?.name}</div>
                    </div>
                    <div class="font-black text-xl" style="color: ${cSc}">${c}</div>
                </div>`;
            }).join('');

            // 4. Scorers Today (Fix aspect ratio)
            const todays = stats.filter(s => s.type === 'goal' && s.date === date);
            const todayCounts = {};
            todays.forEach(s => todayCounts[s.playerId] = (todayCounts[s.playerId]||0)+s.count);
            
            document.getElementById('daily-today-scorers').innerHTML = Object.entries(todayCounts).map(([pid, c]) => {
                const p = players.find(x => x.id == pid);
                return `
                <div class="bg-black border border-gray-600 rounded overflow-hidden flex flex-col">
                    <div class="aspect-[3/4] w-full bg-gray-800 relative">
                        <img src="${p?.img||''}" class="w-full h-full object-cover">
                        <div class="absolute bottom-0 w-full bg-gradient-to-t from-black to-transparent h-1/2"></div>
                        <div class="absolute bottom-1 right-1 text-black text-xs font-bold px-1.5 rounded" style="background-color: ${cSc}">${c} ‡∏•‡∏π‡∏Å</div>
                    </div>
                    <div class="p-1 text-center bg-gray-900">
                        <div class="text-white text-[10px] truncate font-bold">${p?.name}</div>
                    </div>
                </div>`;
            }).join('');
        }

        // --- 4. STATS & HISTORY (No change) ---

        function showHistory(type, button) {
            document.getElementById('history-match-list').classList.add('hidden');
            document.getElementById('history-stat-list').classList.add('hidden');
            document.querySelectorAll('.hist-tab').forEach(btn => {
                btn.classList.remove('border-yellow-400', 'text-yellow-400');
                btn.classList.add('text-gray-400');
            });

            if (type === 'match') {
                document.getElementById('history-match-list').classList.remove('hidden');
            } else {
                document.getElementById('history-stat-list').classList.remove('hidden');
            }
            
            button.classList.add('border-yellow-400', 'text-yellow-400');
            button.classList.remove('text-gray-400');
        }

        function updateStatPlayers() {
            const tid = document.getElementById('s-team').value;
            const ps = players.filter(p => p.teamId == tid);
            document.getElementById('s-player').innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</option>' + ps.map(p => `<option value="${p.id}">${p.no} ${p.name}</option>`).join('');
        }
        function adjStat(v) {
            const el = document.getElementById('s-count');
            let val = parseInt(el.value) + v;
            if(val < 1) val = 1;
            el.value = val;
        }

        // Match Logic
        function handleMatchSubmit(e) {
            e.preventDefault();
            const id = document.getElementById('match-edit-id').value;
            const obj = {
                id: id || Date.now(),
                date: document.getElementById('match-date').value, 
                teamA: document.getElementById('m-team-a').value,
                teamB: document.getElementById('m-team-b').value,
                scoreA: document.getElementById('m-score-a').value,
                scoreB: document.getElementById('m-score-b').value
            };
            if(id) {
                const idx = matches.findIndex(m => m.id == id);
                matches[idx] = obj;
                resetMatchForm();
            } else {
                matches.push(obj);
            }
            save();
        }
        function renderMatchHistory() {
            const list = document.getElementById('history-match-list');
            list.innerHTML = matches.sort((a,b) => b.id - a.id).map(m => {
                const tA = teams.find(x => x.id == m.teamA)?.name || '‡∏ó‡∏µ‡∏° A';
                const tB = teams.find(x => x.id == m.teamB)?.name || '‡∏ó‡∏µ‡∏° B';
                return `
                <div class="bg-gray-800 p-2 rounded flex justify-between items-center text-sm border border-yellow-400/20 group">
                    <div class="flex-1 min-w-0">
                        <span class="text-gray-500 text-xs mr-2">${formatDate(m.date)}</span>
                        <div class="font-bold truncate">${tA} <span class="text-yellow-400">${m.scoreA}</span> : <span class="text-yellow-400">${m.scoreB}</span> ${tB}</div>
                    </div>
                    <div class="opacity-0 group-hover:opacity-100 transition flex gap-2">
                        <button onclick="editMatch(${m.id})" class="text-blue-400 hover:text-blue-300"><i class="fas fa-edit"></i></button>
                        <button onclick="delMatch(${m.id})" class="text-red-400 hover:text-red-300"><i class="fas fa-trash"></i></button>
                    </div>
                </div>`;
            }).join('');
        }
        function editMatch(id) {
            const m = matches.find(x => x.id == id);
            document.getElementById('match-edit-id').value = m.id;
            document.getElementById('match-date').value = m.date;
            document.getElementById('m-team-a').value = m.teamA;
            document.getElementById('m-team-b').value = m.teamB;
            document.getElementById('m-score-a').value = m.scoreA;
            document.getElementById('m-score-b').value = m.scoreB;
            document.getElementById('btn-match-save').innerHTML = '<i class="fas fa-save"></i> ‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï';
        }
        function resetMatchForm() {
            document.getElementById('match-edit-id').value = "";
            document.getElementById('m-score-a').value = 0;
            document.getElementById('m-score-b').value = 0;
            document.getElementById('btn-match-save').innerHTML = '<i class="fas fa-save"></i>';
        }
        function delMatch(id) { if(confirm('‡∏•‡∏ö‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ô‡∏µ‡πâ?')) { matches = matches.filter(m => m.id != id); save(); }}

        // Stat Logic
        function handleStatSubmit(e) {
            e.preventDefault();
            const id = document.getElementById('edit-stat-id').value;
            const obj = {
                id: id || Date.now(),
                date: document.getElementById('s-date').value,
                type: document.getElementById('s-type').value,
                teamId: document.getElementById('s-team').value,
                playerId: document.getElementById('s-player').value,
                count: parseInt(document.getElementById('s-count').value),
                note: document.getElementById('s-note').value
            };

            if(id) {
                const idx = stats.findIndex(s => s.id == id);
                stats[idx] = obj;
                resetStatForm();
            } else {
                stats.push(obj);
            }
            save();
        }
        function renderStatHistory() {
            const list = document.getElementById('history-stat-list');
            const iconMap = { goal:'‚öΩ', yellow:'üü®', red:'üü•', save:'üß§' };
            
            list.innerHTML = stats.sort((a,b) => b.id - a.id).map(s => {
                const p = players.find(x => x.id == s.playerId);
                return `
                <div class="bg-gray-800 p-2 rounded flex justify-between items-center text-sm border border-yellow-400/20 group">
                    <div class="flex items-center gap-2">
                        <span class="text-gray-500 text-xs">${formatDate(s.date)}</span>
                        <span>${iconMap[s.type]}</span>
                        <div>
                            <div class="font-bold">${p?.name}</div>
                            <div class="text-xs text-gray-400">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô: ${s.count} | ${s.note}</div>
                        </div>
                    </div>
                    <div class="opacity-0 group-hover:opacity-100 transition flex gap-2">
                        <button onclick="editStat(${s.id})" class="text-blue-400 hover:text-blue-300"><i class="fas fa-edit"></i></button>
                        <button onclick="delStat(${s.id})" class="text-red-400 hover:text-red-300"><i class="fas fa-trash"></i></button>
                    </div>
                </div>`;
            }).join('');
        }
        function editStat(id) {
            const s = stats.find(x => x.id == id);
            document.getElementById('edit-stat-id').value = s.id;
            document.getElementById('s-date').value = s.date;
            document.getElementById('s-type').value = s.type;
            document.getElementById('s-team').value = s.teamId;
            updateStatPlayers();
            document.getElementById('s-player').value = s.playerId;
            document.getElementById('s-count').value = s.count;
            document.getElementById('s-note').value = s.note;
            document.getElementById('btn-stat-save').innerText = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï';
            document.getElementById('btn-stat-cancel').classList.remove('hidden');
        }
        function resetStatForm() {
            document.getElementById('edit-stat-id').value = "";
            document.getElementById('s-note').value = "";
            document.getElementById('s-count').value = 1;
            document.getElementById('btn-stat-save').innerText = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
            document.getElementById('btn-stat-cancel').classList.add('hidden');
            document.getElementById('s-team').value = '';
            document.getElementById('s-player').innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞</option>';
        }
        function delStat(id) { if(confirm('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ?')) { stats = stats.filter(s => s.id != id); save(); }}

        function renderHistoryLog() {
            renderMatchHistory();
            renderStatHistory();
        }

        // --- 5. TEAMS & PLAYERS ---
        async function handleTeamSubmit(e) {
            e.preventDefault();
            const id = document.getElementById('team-edit-id').value;
            const file = document.getElementById('team-logo').files[0];
            let logo = null;
            
            if(file) logo = await compressImage(file);

            const teamObj = {
                id: id || Date.now(),
                name: document.getElementById('team-name').value,
                color: document.getElementById('team-color').value,
                tel: document.getElementById('team-tel').value, // New field
                logo: logo || (id ? teams.find(t => t.id == id)?.logo : null)
            };

            if(id) {
                const index = teams.findIndex(t => t.id == id);
                teams[index] = teamObj;
                resetTeamForm();
            } else {
                teams.push(teamObj);
            }
            
            save();
            e.target.reset();
        }
        function renderTeams() {
            const grid = document.getElementById('team-grid');
            grid.innerHTML = teams.map(t => `
                <div class="bg-gray-800 rounded-xl p-4 flex items-center gap-4 relative group border-l-4 shadow-lg hover:shadow-xl transition" style="border-color: ${t.color}">
                    <img src="${t.logo||''}" class="w-16 h-16 logo-circle bg-white p-1 border-2 border-gray-600">
                    <div>
                        <h3 class="font-bold text-lg">${t.name}</h3>
                        <div class="text-xs text-gray-400">${players.filter(p=>p.teamId==t.id).length} players</div>
                        ${t.tel ? `<div class="text-xs text-yellow-400 flex items-center gap-1"><i class="fas fa-phone-alt text-xs"></i> ${t.tel}</div>` : ''}
                    </div>
                    <div class="absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition">
                        <button onclick="editTeam(${t.id})" class="text-blue-400 bg-black/50 rounded-full w-6 h-6 text-xs hover:text-blue-300"><i class="fas fa-edit"></i></button>
                        <button onclick="delTeam(${t.id})" class="text-red-500 bg-black/50 rounded-full w-6 h-6 text-xs hover:text-red-300"><i class="fas fa-trash"></i></button>
                    </div>
                </div>
            `).join('');
            
            // Team Tabs for Player List
            const tabs = document.getElementById('player-team-tabs');
            tabs.innerHTML = `<button onclick="renderPlayers('all', this)" class="team-tab bg-yellow-500 text-black px-4 py-1 rounded-full whitespace-nowrap text-sm font-bold transition">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>` + 
                teams.map(t => `<button onclick="renderPlayers(${t.id}, this)" class="team-tab bg-gray-700 text-white border border-gray-600 px-4 py-1 rounded-full whitespace-nowrap text-sm flex items-center gap-2 hover:bg-gray-600 transition"><div class="w-2 h-2 rounded-full" style="background:${t.color}"></div>${t.name}</button>`).join('');
        }
        function editTeam(id) {
            const t = teams.find(x => x.id == id);
            document.getElementById('team-edit-id').value = t.id;
            document.getElementById('team-name').value = t.name;
            document.getElementById('team-color').value = t.color;
            document.getElementById('team-tel').value = t.tel || ''; // Load tel
            document.getElementById('btn-team-save').innerText = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏ó‡∏µ‡∏°';
            document.getElementById('btn-team-cancel').classList.remove('hidden');
        }
        function resetTeamForm() {
            document.getElementById('team-edit-id').value = '';
            document.getElementById('team-name').value = '';
            document.getElementById('team-color').value = '#ffffff';
            document.getElementById('team-tel').value = '';
            document.getElementById('team-logo').value = '';
            document.getElementById('btn-team-save').innerText = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
            document.getElementById('btn-team-cancel').classList.add('hidden');
        }
        function delTeam(id) { 
            if(confirm('‡∏•‡∏ö‡∏ó‡∏µ‡∏°‡∏ô‡∏µ‡πâ? ‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞‡πÅ‡∏•‡∏∞‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Ç‡πâ‡∏≠‡∏á‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏•‡∏ö‡∏≠‡∏≠‡∏Å‡∏î‡πâ‡∏ß‡∏¢!')) { 
                teams = teams.filter(t => t.id != id);
                players = players.filter(p => p.teamId != id); 
                stats = stats.filter(s => s.teamId != id); 
                matches = matches.filter(m => m.teamA != id && m.teamB != id);
                save();
            }
        }

        // Player Logic
        function openPlayerModal(player = null) { 
            document.getElementById('p-id').value = '';
            document.getElementById('player-modal-title').innerText = '‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞‡πÉ‡∏´‡∏°‡πà';
            if (player) {
                document.getElementById('p-id').value = player.id;
                document.getElementById('p-name').value = player.name;
                document.getElementById('p-no').value = player.no;
                document.getElementById('p-team').value = player.teamId;
                document.getElementById('p-manager').checked = player.manager;
                document.getElementById('player-modal-title').innerText = '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞';
                document.getElementById('btn-player-save').innerText = '‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•';
            } else {
                document.getElementById('btn-player-save').innerText = '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å';
            }
            document.getElementById('player-modal').classList.remove('hidden'); 
        }
        function closePlayerModal() {
            document.getElementById('player-modal').classList.add('hidden');
            document.getElementById('player-modal').querySelector('form').reset();
        }
        async function handlePlayerSubmit(e) {
            e.preventDefault();
            const id = document.getElementById('p-id').value;
            const file = document.getElementById('p-img').files[0];
            let img = null;
            
            if(file) {
                img = await compressImage(file);
            } else if (id) {
                img = players.find(p => p.id == id)?.img;
            }
            
            const playerObj = {
                id: id || Date.now(),
                name: document.getElementById('p-name').value,
                no: document.getElementById('p-no').value,
                teamId: document.getElementById('p-team').value,
                manager: document.getElementById('p-manager').checked,
                img: img
            };

            if(id) {
                const index = players.findIndex(p => p.id == id);
                players[index] = playerObj;
            } else {
                players.push(playerObj);
            }
            
            save();
            closePlayerModal();
        }
        
        function renderPlayers(teamId = 'all', button = null) {
            currentTeamView = teamId;
            
            // Update button styles
            document.querySelectorAll('.team-tab').forEach(btn => {
                btn.classList.remove('bg-yellow-500', 'text-black', 'font-bold');
                btn.classList.add('bg-gray-700', 'text-white', 'font-medium');
            });

            if (button) {
                button.classList.add('bg-yellow-500', 'text-black', 'font-bold');
                button.classList.remove('bg-gray-700', 'text-white', 'font-medium');
            } else if (teamId === 'all') {
                document.querySelector('.team-tab').classList.add('bg-yellow-500', 'text-black', 'font-bold');
                document.querySelector('.team-tab').classList.remove('bg-gray-700', 'text-white', 'font-medium');
            }


            // Banner Logic
            const banner = document.getElementById('player-team-banner');
            
            if(teamId !== 'all') {
                const t = teams.find(x => x.id == teamId);
                const memberCount = players.filter(p => p.teamId == teamId).length;
                banner.classList.remove('hidden');
                banner.style.background = `linear-gradient(135deg, ${t.color} 0%, #0c1626 100%)`;
                banner.style.borderColor = t.color;
                document.getElementById('ptb-name').innerText = t.name;
                document.getElementById('ptb-logo').src = t.logo || '';
                document.getElementById('ptb-logo').style.borderColor = t.color;
                document.getElementById('ptb-member-count').innerText = memberCount;
                document.getElementById('ptb-color-picker').value = t.color;
                document.getElementById('ptb-color-picker').dataset.tid = t.id;

            } else {
                banner.classList.add('hidden');
            }

            const list = players.filter(p => teamId === 'all' || p.teamId == teamId);
            document.getElementById('player-grid').innerHTML = list.map(p => {
                const t = teams.find(x => x.id == p.teamId);
                const borderColor = t ? t.color : '#facc15';
                return `
                <div class="player-card rounded-xl overflow-hidden relative group">
                    <div class="player-photo-container flex items-end justify-center" style="border-bottom-color: ${borderColor}">
                        <span class="absolute top-2 left-2 text-6xl font-black text-white/5 italic z-0">${p.no}</span>
                        <img src="${p.img||''}" class="drop-shadow-lg relative z-10">
                        <button onclick="editPlayer(${p.id})" class="absolute top-2 right-2 text-blue-400 opacity-0 group-hover:opacity-100 bg-black/50 rounded-full w-6 h-6 text-xs z-20 hover:text-blue-300"><i class="fas fa-edit"></i></button>
                    </div>
                    <div class="p-2 text-center bg-gray-900 border-t border-gray-700">
                        <div class="font-bold text-white truncate">${p.name}</div>
                        <div class="text-xs text-gray-400 uppercase">${t?.name}</div>
                        ${p.manager ? '<div class="text-[10px] bg-yellow-500 text-black inline-block px-1 rounded mt-1 font-bold">Manager</div>' : ''}
                    </div>
                    <button onclick="delPlayer(${p.id})" class="absolute bottom-1 right-1 text-red-500 opacity-0 group-hover:opacity-100 transition bg-black/50 rounded-full w-6 h-6 text-xs hover:text-red-300"><i class="fas fa-trash"></i></button>
                </div>`;
            }).join('');
        }
        function editPlayer(id) {
            const p = players.find(x => x.id == id);
            openPlayerModal(p);
        }
        function delPlayer(id) { 
            if(confirm('‡∏•‡∏ö‡∏ô‡∏±‡∏Å‡πÄ‡∏ï‡∏∞?')) { 
                players = players.filter(p => p.id != id); 
                stats = stats.filter(s => s.playerId != id);
                save(); 
            }
        }
        
        function updateTeamColorLive(input) {
            const tid = input.dataset.tid;
            const t = teams.find(x => x.id == tid);
            if(t) {
                t.color = input.value;
                localStorage.setItem('jl_teams', JSON.stringify(teams));
                
                document.getElementById('player-team-banner').style.background = `linear-gradient(135deg, ${t.color} 0%, #0c1626 100%)`;
                document.getElementById('player-team-banner').style.borderColor = t.color;
                document.getElementById('ptb-logo').style.borderColor = t.color;
            }
        }

        // Global Settings
        function toggleSettings() { document.getElementById('settings-modal').classList.toggle('hidden'); }
        async function saveGlobalLogo() {
            const f = document.getElementById('global-logo-upload').files[0];
            if(f) {
                globalLogo = await compressImage(f);
                save();
                document.getElementById('daily-logo-img').src = globalLogo;
                toggleSettings();
            }
        }

    </script>
</body>
</html>
